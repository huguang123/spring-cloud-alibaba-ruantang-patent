import{u as t,a as e,b as a,c as r,e as o,d as n,S as i,f as l,Z as s,g as d,h as u,r as c,j as f,k as h,l as m,m as p,n as g,o as v,i as y}from"./echarts-f3f581e5.js";import{s as w}from"./request-a996bc5b.js";import{E as x,G as b,O as M,b as S,P as k,au as C,K as I,L as _,Y as T,X as E,I as O,J as A,V as R,a3 as z,a5 as L,ad as P,an as V,a6 as F}from"./elementPlus-e3fc6f82.js";import{x as D,r as W,X as B,k as U,S as j,n as N,z as X,P as Y,H as $,O as H,A as G,y as q,a4 as J,G as K,L as Z}from"./vue-4e979bb7.js";import{_ as Q}from"./index-08374d78.js";t([e,a]),t(r),o({type:"series.wordCloud",visualStyleAccessPath:"textStyle",visualStyleMapper:function(t){return{fill:t.get("color")}},visualDrawType:"fill",optionUpdated:function(){var t=this.option;t.gridSize=Math.max(Math.floor(t.gridSize),4)},getInitialData:function(t,e){var a=n(t.data,{coordDimensions:["value"]}),r=new i(a,this);return r.initData(t.data),r},defaultOption:{maskImage:null,shape:"circle",keepAspect:!1,left:"center",top:"center",width:"70%",height:"80%",sizeRange:[12,60],rotationRange:[-90,90],rotationStep:45,gridSize:8,drawOutOfBound:!1,shrinkToFit:!1,textStyle:{fontWeight:"normal"}}}),l({type:"wordCloud",render:function(t,e,a){var r=this.group;r.removeAll();var o=t.getData(),n=t.get("gridSize");t.layoutInstance.ondraw=function(e,a,i,l){var c=o.getItemModel(i),f=c.getModel("textStyle"),h=new s({style:d(f),scaleX:1/l.info.mu,scaleY:1/l.info.mu,x:(l.gx+l.info.gw/2)*n,y:(l.gy+l.info.gh/2)*n,rotation:l.rot});h.setStyle({x:l.info.fillTextOffsetX,y:l.info.fillTextOffsetY+.5*a,text:e,verticalAlign:"middle",fill:o.getItemVisual(i,"style").fill,fontSize:a}),r.add(h),o.setItemGraphicEl(i,h),h.ensureState("emphasis").style=d(c.getModel(["emphasis","textStyle"]),{state:"emphasis"}),h.ensureState("blur").style=d(c.getModel(["blur","textStyle"]),{state:"blur"}),u(h,c.get(["emphasis","focus"]),c.get(["emphasis","blurScope"])),h.stateTransition={duration:t.get("animation")?t.get(["stateAnimation","duration"]):0,easing:t.get(["stateAnimation","easing"])},h.__highDownDispatcher=!0},this._model=t},remove:function(){this.group.removeAll(),this._model.layoutInstance.dispose()},dispose:function(){this._model.layoutInstance.dispose()}}),
/*!
 * wordcloud2.js
 * http://timdream.org/wordcloud2.js/
 *
 * Copyright 2011 - 2019 Tim Guan-tin Chien and contributors.
 * Released under the MIT license
 */
window.setImmediate||(window.setImmediate=window.msSetImmediate||window.webkitSetImmediate||window.mozSetImmediate||window.oSetImmediate||function(){if(!window.postMessage||!window.addEventListener)return null;var t=[void 0],e="zero-timeout-message";return window.addEventListener("message",(function(a){if("string"==typeof a.data&&a.data.substr(0,20)===e){a.stopImmediatePropagation();var r=parseInt(a.data.substr(20),36);t[r]&&(t[r](),t[r]=void 0)}}),!0),window.clearImmediate=function(e){t[e]&&(t[e]=void 0)},function(a){var r=t.length;return t.push(a),window.postMessage(e+r.toString(36),"*"),r}}()||function(t){window.setTimeout(t,0)}),window.clearImmediate||(window.clearImmediate=window.msClearImmediate||window.webkitClearImmediate||window.mozClearImmediate||window.oClearImmediate||function(t){window.clearTimeout(t)});var tt=function(){var t=document.createElement("canvas");if(!t||!t.getContext)return!1;var e=t.getContext("2d");return!!e&&(!!e.getImageData&&(!!e.fillText&&(!!Array.prototype.some&&!!Array.prototype.push)))}(),et=function(){if(tt){for(var t,e,a=document.createElement("canvas").getContext("2d"),r=20;r;){if(a.font=r.toString(10)+"px sans-serif",a.measureText("Ｗ").width===t&&a.measureText("m").width===e)return r+1;t=a.measureText("Ｗ").width,e=a.measureText("m").width,r--}return 0}}(),at=function(t){for(var e,a,r=t.length;r;)e=Math.floor(Math.random()*r),a=t[--r],t[r]=t[e],t[e]=a;return t},rt={},ot=function(t,e){if(tt){var a=Math.floor(Math.random()*Date.now());Array.isArray(t)||(t=[t]),t.forEach((function(e,a){if("string"==typeof e){if(t[a]=document.getElementById(e),!t[a])throw new Error("The element id specified is not found.")}else if(!e.tagName&&!e.appendChild)throw new Error("You must pass valid HTML elements, or ID of the element.")}));var r={list:[],fontFamily:'"Trebuchet MS", "Heiti TC", "微軟正黑體", "Arial Unicode MS", "Droid Fallback Sans", sans-serif',fontWeight:"normal",color:"random-dark",minSize:0,weightFactor:1,clearCanvas:!0,backgroundColor:"#fff",gridSize:8,drawOutOfBound:!1,shrinkToFit:!1,origin:null,drawMask:!1,maskColor:"rgba(255,0,0,0.3)",maskGapWidth:.3,layoutAnimation:!0,wait:0,abortThreshold:0,abort:function(){},minRotation:-Math.PI/2,maxRotation:Math.PI/2,rotationStep:.1,shuffle:!0,rotateRatio:.1,shape:"circle",ellipticity:.65,classes:null,hover:null,click:null};if(e)for(var o in e)o in r&&(r[o]=e[o]);if("function"!=typeof r.weightFactor){var n=r.weightFactor;r.weightFactor=function(t){return t*n}}if("function"!=typeof r.shape)switch(r.shape){case"circle":default:r.shape="circle";break;case"cardioid":r.shape=function(t){return 1-Math.sin(t)};break;case"diamond":r.shape=function(t){var e=t%(2*Math.PI/4);return 1/(Math.cos(e)+Math.sin(e))};break;case"square":r.shape=function(t){return Math.min(1/Math.abs(Math.cos(t)),1/Math.abs(Math.sin(t)))};break;case"triangle-forward":r.shape=function(t){var e=t%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))};break;case"triangle":case"triangle-upright":r.shape=function(t){var e=(t+3*Math.PI/2)%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))};break;case"pentagon":r.shape=function(t){var e=(t+.955)%(2*Math.PI/5);return 1/(Math.cos(e)+.726543*Math.sin(e))};break;case"star":r.shape=function(t){var e=(t+.955)%(2*Math.PI/10);return(t+.955)%(2*Math.PI/5)-2*Math.PI/10>=0?1/(Math.cos(2*Math.PI/10-e)+3.07768*Math.sin(2*Math.PI/10-e)):1/(Math.cos(e)+3.07768*Math.sin(e))}}r.gridSize=Math.max(Math.floor(r.gridSize),4);var i,l,s,d,u,c,f,h,m=r.gridSize,p=m-r.maskGapWidth,g=Math.abs(r.maxRotation-r.minRotation),v=Math.min(r.maxRotation,r.minRotation),y=r.rotationStep;switch(r.color){case"random-dark":f=function(){return R(10,50)};break;case"random-light":f=function(){return R(50,90)};break;default:"function"==typeof r.color&&(f=r.color)}"function"==typeof r.fontWeight&&(h=r.fontWeight);var w=null;"function"==typeof r.classes&&(w=r.classes);var x,b=!1,M=[],S=function(t){var e,a,r=t.currentTarget,o=r.getBoundingClientRect();t.touches?(e=t.touches[0].clientX,a=t.touches[0].clientY):(e=t.clientX,a=t.clientY);var n=e-o.left,i=a-o.top,l=Math.floor(n*(r.width/o.width||1)/m),s=Math.floor(i*(r.height/o.height||1)/m);return M[l]?M[l][s]:null},k=function(t){var e=S(t);x!==e&&(x=e,e?r.hover(e.item,e.dimension,t):r.hover(void 0,void 0,t))},C=function(t){var e=S(t);e&&(r.click(e.item,e.dimension,t),t.preventDefault())},I=[],_=function(t){if(I[t])return I[t];var e=8*t,a=e,o=[];for(0===t&&o.push([d[0],d[1],0]);a--;){var n=1;"circle"!==r.shape&&(n=r.shape(a/e*2*Math.PI)),o.push([d[0]+t*n*Math.cos(-a/e*2*Math.PI),d[1]+t*n*Math.sin(-a/e*2*Math.PI)*r.ellipticity,a/e*2*Math.PI])}return I[t]=o,o},T=function(){return r.abortThreshold>0&&(new Date).getTime()-c>r.abortThreshold},E=function(e,a,r,o,n){if(!(e>=l||a>=s||e<0||a<0)){if(i[e][a]=!1,r)t[0].getContext("2d").fillRect(e*m,a*m,p,p);b&&(M[e][a]={item:n,dimension:o})}},O=function e(a,o){if(o>20)return null;var n,d,c;Array.isArray(a)?(n=a[0],d=a[1]):(n=a.word,d=a.weight,c=a.attributes);var p=0===r.rotateRatio||Math.random()>r.rotateRatio?0:0===g?v:v+Math.round(Math.random()*g/y)*y,x=function(t){if(Array.isArray(t)){var e=t.slice();return e.splice(0,2),e}return[]}(a),M=function(t,e,a,o){var n=r.weightFactor(e);if(n<=r.minSize)return!1;var i,l=1;n<et&&(l=function(){for(var t=2;t*n<et;)t+=2;return t}()),i=h?h(t,e,n,o):r.fontWeight;var s=document.createElement("canvas"),d=s.getContext("2d",{willReadFrequently:!0});d.font=i+" "+(n*l).toString(10)+"px "+r.fontFamily;var u=d.measureText(t).width/l,c=Math.max(n*l,d.measureText("m").width,d.measureText("Ｗ").width)/l,f=u+2*c,p=3*c,g=Math.ceil(f/m),v=Math.ceil(p/m);f=g*m,p=v*m;var y=-u/2,w=.4*-c,x=Math.ceil((f*Math.abs(Math.sin(a))+p*Math.abs(Math.cos(a)))/m),b=Math.ceil((f*Math.abs(Math.cos(a))+p*Math.abs(Math.sin(a)))/m),M=b*m,S=x*m;s.setAttribute("width",M),s.setAttribute("height",S),d.scale(1/l,1/l),d.translate(M*l/2,S*l/2),d.rotate(-a),d.font=i+" "+(n*l).toString(10)+"px "+r.fontFamily,d.fillStyle="#000",d.textBaseline="middle",d.fillText(t,y*l,(w+.5*n)*l);var k=d.getImageData(0,0,M,S).data;if(T())return!1;for(var C,I,_,E=[],O=b,A=[x/2,b/2,x/2,b/2];O--;)for(C=x;C--;){_=m;t:for(;_--;)for(I=m;I--;)if(k[4*((C*m+_)*M+(O*m+I))+3]){E.push([O,C]),O<A[3]&&(A[3]=O),O>A[1]&&(A[1]=O),C<A[0]&&(A[0]=C),C>A[2]&&(A[2]=C);break t}}return{mu:l,occupied:E,bounds:A,gw:b,gh:x,fillTextOffsetX:y,fillTextOffsetY:w,fillTextWidth:u,fillTextHeight:c,fontSize:n}}(n,d,p,x);if(!M)return!1;if(T())return!1;if(!r.drawOutOfBound&&!r.shrinkToFit){var S=M.bounds;if(S[1]-S[3]+1>l||S[2]-S[0]+1>s)return!1}for(var k=u+1,C=function(e){var o=Math.floor(e[0]-M.gw/2),g=Math.floor(e[1]-M.gh/2);M.gw,M.gh;return!!function(t,e,a,o,n){for(var d=n.length;d--;){var u=t+n[d][0],c=e+n[d][1];if(u>=l||c>=s||u<0||c<0){if(!r.drawOutOfBound)return!1}else if(!i[u][c])return!1}return!0}(o,g,0,0,M.occupied)&&(function(e,a,o,n,i,l,s,d,u,c){var p,g,v,y=o.fontSize;p=f?f(n,i,y,l,s,c):r.color,g=h?h(n,i,y,c):r.fontWeight,v=w?w(n,i,y,c):r.classes,t.forEach((function(t){if(t.getContext){var i=t.getContext("2d"),l=o.mu;i.save(),i.scale(1/l,1/l),i.font=g+" "+(y*l).toString(10)+"px "+r.fontFamily,i.fillStyle=p,i.translate((e+o.gw/2)*m*l,(a+o.gh/2)*m*l),0!==d&&i.rotate(-d),i.textBaseline="middle",i.fillText(n,o.fillTextOffsetX*l,(o.fillTextOffsetY+.5*y)*l),i.restore()}else{var s=document.createElement("span"),c="";c="rotate("+-d/Math.PI*180+"deg) ",1!==o.mu&&(c+="translateX(-"+o.fillTextWidth/4+"px) scale("+1/o.mu+")");var f={position:"absolute",display:"block",font:g+" "+y*o.mu+"px "+r.fontFamily,left:(e+o.gw/2)*m+o.fillTextOffsetX+"px",top:(a+o.gh/2)*m+o.fillTextOffsetY+"px",width:o.fillTextWidth+"px",height:o.fillTextHeight+"px",lineHeight:y+"px",whiteSpace:"nowrap",transform:c,webkitTransform:c,msTransform:c,transformOrigin:"50% 40%",webkitTransformOrigin:"50% 40%",msTransformOrigin:"50% 40%"};for(var h in p&&(f.color=p),s.textContent=n,f)s.style[h]=f[h];if(u)for(var w in u)s.setAttribute(w,u[w]);v&&(s.className+=v),t.appendChild(s)}}))}(o,g,M,n,d,u-k,e[2],p,c,x),function(e,a,o,n,i,d){var u,c,f=i.occupied,h=r.drawMask;if(h&&((u=t[0].getContext("2d")).save(),u.fillStyle=r.maskColor),b){var p=i.bounds;c={x:(e+p[3])*m,y:(a+p[0])*m,w:(p[1]-p[3]+1)*m,h:(p[2]-p[0]+1)*m}}for(var g=f.length;g--;){var v=e+f[g][0],y=a+f[g][1];v>=l||y>=s||v<0||y<0||E(v,y,h,c,d)}h&&u.restore()}(o,g,0,0,M,a),{gx:o,gy:g,rot:p,info:M})};k--;){var I=_(u-k);r.shuffle&&(I=[].concat(I),at(I));for(var O=0;O<I.length;O++){var A=C(I[O]);if(A)return A}}return r.shrinkToFit?(Array.isArray(a)?a[1]=3*a[1]/4:a.weight=3*a.weight/4,e(a,o+1)):null},A=function(e,a,r){if(a)return!t.some((function(t){var a=new CustomEvent(e,{detail:r||{}});return!t.dispatchEvent(a)}),this);t.forEach((function(t){var a=new CustomEvent(e,{detail:r||{}});t.dispatchEvent(a)}),this)};!function(){var e=t[0];if(e.getContext)l=Math.ceil(e.width/m),s=Math.ceil(e.height/m);else{var o=e.getBoundingClientRect();l=Math.ceil(o.width/m),s=Math.ceil(o.height/m)}if(A("wordcloudstart",!0)){var n,f,h,p,g;if(d=r.origin?[r.origin[0]/m,r.origin[1]/m]:[l/2,s/2],u=Math.floor(Math.sqrt(l*l+s*s)),i=[],!e.getContext||r.clearCanvas)for(t.forEach((function(t){if(t.getContext){var e=t.getContext("2d");e.fillStyle=r.backgroundColor,e.clearRect(0,0,l*(m+1),s*(m+1)),e.fillRect(0,0,l*(m+1),s*(m+1))}else t.textContent="",t.style.backgroundColor=r.backgroundColor,t.style.position="relative"})),n=l;n--;)for(i[n]=[],f=s;f--;)i[n][f]=!0;else{var v=document.createElement("canvas").getContext("2d");v.fillStyle=r.backgroundColor,v.fillRect(0,0,1,1);var y,w,S=v.getImageData(0,0,1,1).data,I=e.getContext("2d").getImageData(0,0,l*m,s*m).data;for(n=l;n--;)for(i[n]=[],f=s;f--;){w=m;t:for(;w--;)for(y=m;y--;)for(h=4;h--;)if(I[4*((f*m+w)*l*m+(n*m+y))+h]!==S[h]){i[n][f]=!1;break t}!1!==i[n][f]&&(i[n][f]=!0)}I=v=S=void 0}if(r.hover||r.click){for(b=!0,n=l+1;n--;)M[n]=[];r.hover&&e.addEventListener("mousemove",k),r.click&&(e.addEventListener("click",C),e.addEventListener("touchstart",C),e.addEventListener("touchend",(function(t){t.preventDefault()})),e.style.webkitTapHighlightColor="rgba(0, 0, 0, 0)"),e.addEventListener("wordcloudstart",(function t(){e.removeEventListener("wordcloudstart",t),e.removeEventListener("mousemove",k),e.removeEventListener("click",C),x=void 0}))}h=0;var _=!0;r.layoutAnimation?0!==r.wait?(p=window.setTimeout,g=window.clearTimeout):(p=window.setImmediate,g=window.clearImmediate):(p=function(t){t()},g=function(){_=!1});var E=function(e,a){t.forEach((function(t){t.removeEventListener(e,a)}),this)},R=function t(){E("wordcloudstart",t),g(rt[a])};!function(e,a){t.forEach((function(t){t.addEventListener(e,a)}),this)}("wordcloudstart",R),rt[a]=(r.layoutAnimation?p:setTimeout)((function t(){if(_){if(h>=r.list.length)return g(rt[a]),A("wordcloudstop",!1),E("wordcloudstart",R),void delete rt[a];c=(new Date).getTime();var e=O(r.list[h],0),o=!A("wordclouddrawn",!0,{item:r.list[h],drawn:e});if(T()||o)return g(rt[a]),r.abort(),A("wordcloudabort",!1),A("wordcloudstop",!1),void E("wordcloudstart",R);h++,rt[a]=p(t,r.wait)}}),r.wait)}}()}function R(t,e){return"hsl("+(360*Math.random()).toFixed()+","+(30*Math.random()+70).toFixed()+"%,"+(Math.random()*(e-t)+t).toFixed()+"%)"}};if(ot.isSupported=tt,ot.minFontSize=et,!ot.isSupported)throw new Error("Sorry your browser not support wordCloud");c((function(t,e){t.eachSeriesByType("wordCloud",(function(a){var r=h(a.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()}),o=a.get("keepAspect"),n=a.get("maskImage"),i=n?n.width/n.height:1;o&&function(t,e){var a=t.width,r=t.height;a>r*e?(t.x+=(a-r*e)/2,t.width=r*e):(t.y+=(r-a/e)/2,t.height=a/e)}(r,i);var l=a.getData(),s=document.createElement("canvas");s.width=r.width,s.height=r.height;var d=s.getContext("2d");if(n)try{d.drawImage(n,0,0,s.width,s.height),function(t){for(var e=t.getContext("2d"),a=e.getImageData(0,0,t.width,t.height),r=e.createImageData(a),o=0,n=0,i=0;i<a.data.length;i+=4)a.data[i+3]>128&&(o+=s=a.data[i]+a.data[i+1]+a.data[i+2],++n);var l=o/n;for(i=0;i<a.data.length;i+=4){var s=a.data[i]+a.data[i+1]+a.data[i+2];a.data[i+3]<128||s>l?(r.data[i]=0,r.data[i+1]=0,r.data[i+2]=0,r.data[i+3]=0):(r.data[i]=255,r.data[i+1]=255,r.data[i+2]=255,r.data[i+3]=255)}e.putImageData(r,0,0)}(s)}catch(y){console.error("Invalid mask image"),console.error(y.toString())}var u=a.get("sizeRange"),c=a.get("rotationRange"),f=l.getDataExtent("value"),p=Math.PI/180,g=a.get("gridSize");function v(t){var e=t.detail.item;t.detail.drawn&&a.layoutInstance.ondraw&&(t.detail.drawn.gx+=r.x/g,t.detail.drawn.gy+=r.y/g,a.layoutInstance.ondraw(e[0],e[1],e[2],t.detail.drawn))}ot(s,{list:l.mapArray("value",(function(t,e){var a=l.getItemModel(e);return[l.getName(e),a.get("textStyle.fontSize",!0)||m(t,f,u),e]})).sort((function(t,e){return e[1]-t[1]})),fontFamily:a.get("textStyle.fontFamily")||a.get("emphasis.textStyle.fontFamily")||t.get("textStyle.fontFamily"),fontWeight:a.get("textStyle.fontWeight")||a.get("emphasis.textStyle.fontWeight")||t.get("textStyle.fontWeight"),gridSize:g,ellipticity:r.height/r.width,minRotation:c[0]*p,maxRotation:c[1]*p,clearCanvas:!n,rotateRatio:1,rotationStep:a.get("rotationStep")*p,drawOutOfBound:a.get("drawOutOfBound"),shrinkToFit:a.get("shrinkToFit"),layoutAnimation:a.get("layoutAnimation"),shuffle:!1,shape:a.get("shape")}),s.addEventListener("wordclouddrawn",v),a.layoutInstance&&a.layoutInstance.dispose(),a.layoutInstance={ondraw:null,dispose:function(){s.removeEventListener("wordclouddrawn",v),s.addEventListener("wordclouddrawn",(function(t){t.preventDefault()}))}}}))})),f((function(t){var e=(t||{}).series;!p(e)&&(e=e?[e]:[]);var a=["shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function r(t){t&&g(a,(function(e){t.hasOwnProperty(e)&&(t["text"+v(e)]=t[e])}))}g(e,(function(t){if(t&&"wordCloud"===t.type){var e=t.textStyle||{};r(e.normal),r(e.emphasis)}}))}));const nt={class:"portrait-container"},it={class:"page-header"},lt={class:"company-selector"},st={key:0,class:"empty-state"},dt={class:"card-header"},ut={class:"card-header"},ct={class:"chart-actions"},ft={class:"card-header"},ht={class:"action-footer"},mt={class:"dialog-footer"},pt=Q(D({__name:"Index",setup(t){const e=W([]),a=W([]),r=W(""),o=W(!1),n=W(!1),i=W("3_years"),l=W("application"),s=W(""),d=W(null),u=W(null),c=W(null),f=W(null),h=W(null),m=W(null),p={radar:null,pie:null,trend:null,forecast:null,tagCloud:null,industryCompare:null},g=W(!1),v=B({title:"",format:"pdf",sections:["radar","category","trend","forecast","tags","industry"],remarks:""});U((async()=>{Q(),await D(),window.addEventListener("resize",tt)})),j((()=>{et(),window.removeEventListener("resize",tt)}));const D=async()=>{try{const r=await w({url:"/api/portrait/company/list",method:"get",params:t});e.value=r.data||[];const o=await w({url:"/api/portrait/industries",method:"get"});a.value=o.data||[],a.value.length>0&&(s.value=a.value[0].code)}catch(r){console.error("获取初始数据失败:",r),x.error("获取初始数据失败，请刷新页面重试")}var t},Q=()=>{N((()=>{d.value&&(p.radar=y(d.value)),u.value&&(p.pie=y(u.value)),c.value&&(p.trend=y(c.value)),f.value&&(p.forecast=y(f.value)),h.value&&(p.tagCloud=y(h.value)),m.value&&(p.industryCompare=y(m.value))}))},tt=()=>{Object.values(p).forEach((t=>{t&&t.resize()}))},et=()=>{Object.values(p).forEach((t=>{t&&t.dispose()}))},at=async()=>{var t;if(r.value)try{o.value=!0,v.title=(null==(t=e.value.find((t=>t.id===r.value)))?void 0:t.name)+"专利能力分析报告",await Promise.all([rt(),ot(),pt(),gt(),vt(),yt()]),C({title:"数据加载完成",message:"企业专利能力智能画像已生成",type:"success"})}catch(a){console.error("加载企业数据失败:",a),x.error("数据加载失败，请重试")}finally{o.value=!1}},rt=async()=>{var t;if(r.value)try{const e=await(t=r.value,i.value,w({url:`/api/portrait/company/${t}/radar`,method:"get"}));wt(e.data)}catch(e){console.error("加载雷达图数据失败:",e)}},ot=async()=>{var t;if(r.value)try{const e=await(t=r.value,w({url:`/api/portrait/company/${t}/patent-categories`,method:"get"}));xt(e.data)}catch(e){console.error("加载专利类型数据失败:",e)}},pt=async()=>{var t;if(r.value)try{const e=await(t=r.value,l.value,w({url:`/api/portrait/company/${t}/patent-trend`,method:"get"}));bt(e.data)}catch(e){console.error("加载趋势数据失败:",e)}},gt=async()=>{var t;if(r.value)try{const e=await(t=r.value,w({url:`/api/portrait/company/${t}/patent-forecast`,method:"get"}));Mt(e.data)}catch(e){console.error("加载预测数据失败:",e)}},vt=async()=>{var t,e;if(r.value)try{const a=await(t=r.value,w({url:`/api/portrait/company/${t}/tech-keywords`,method:"get",params:e}));St(a.data)}catch(a){console.error("加载标签云数据失败:",a)}},yt=async()=>{var t;if(r.value&&s.value)try{const e=await(t=r.value,s.value,w({url:`/api/portrait/company/${t}/industry-compare`,method:"get"}));kt(e.data)}catch(e){console.error("加载行业对比数据失败:",e)}},wt=t=>{if(!p.radar)return;const e={color:["#5470c6","#91cc75"],tooltip:{trigger:"item"},legend:{data:[t.companyName,"行业平均"],bottom:0},radar:{indicator:[{name:"技术广度",max:100},{name:"专利质量",max:100},{name:"创新活跃度",max:100},{name:"保护强度",max:100},{name:"技术深度",max:100},{name:"国际化程度",max:100}],radius:"65%",axisName:{color:"#333",fontSize:12}},series:[{name:"企业与行业对比",type:"radar",data:[{value:t.companyScore,name:t.companyName,areaStyle:{opacity:.3},lineStyle:{width:2}},{value:t.industryAvg,name:"行业平均",areaStyle:{opacity:.3},lineStyle:{width:2}}]}]};p.radar.setOption(e)},xt=t=>{if(!p.pie)return;const e={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",right:10,top:"center",data:t.map((t=>t.name))},series:[{name:"专利类型分布",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:4,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"16",fontWeight:"bold"}},labelLine:{show:!1},data:t}]};p.pie.setOption(e)},bt=t=>{if(!p.trend)return;const e={application:"申请量",granted:"授权量",valid:"有效专利"},a={tooltip:{trigger:"axis"},xAxis:{type:"category",data:t.xAxis,boundaryGap:!1},yAxis:{type:"value",name:e[l.value]},series:[{name:e[l.value],type:"line",data:t.series,areaStyle:{opacity:.3},smooth:!0,markPoint:{data:[{type:"max",name:"最大值"},{type:"min",name:"最小值"}]}}]};p.trend.setOption(a)},Mt=t=>{if(!p.forecast)return;const e={tooltip:{trigger:"axis"},legend:{data:["历史数据","预测数据"],bottom:0},xAxis:{type:"category",data:t.xAxis,boundaryGap:!1},yAxis:{type:"value",name:"专利数量"},series:[{name:"历史数据",type:"line",data:t.history,smooth:!0},{name:"预测数据",type:"line",data:t.forecast,smooth:!0,lineStyle:{type:"dashed"},itemStyle:{color:"#e66"}}]};p.forecast.setOption(e)},St=t=>{if(!p.tagCloud)return;const e={tooltip:{show:!0},series:[{type:"wordCloud",shape:"circle",left:"center",top:"center",width:"80%",height:"80%",right:null,bottom:null,sizeRange:[12,45],rotationRange:[-45,45],rotationStep:15,gridSize:8,drawOutOfBound:!1,textStyle:{fontFamily:"sans-serif",fontWeight:"normal",color:function(){return"rgb("+[Math.round(160*Math.random()),Math.round(160*Math.random()),Math.round(160*Math.random())].join(",")+")"}},emphasis:{textStyle:{shadowBlur:10,shadowColor:"#333"}},data:t}]};p.tagCloud.setOption(e)},kt=t=>{if(!p.industryCompare)return;const e={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:[t.companyName,t.industryName],bottom:0},grid:{left:"3%",right:"4%",bottom:"15%",containLabel:!0},xAxis:{type:"category",data:t.dimensions,axisLabel:{interval:0,rotate:30}},yAxis:{type:"value",name:"分值",max:100},series:[{name:t.companyName,type:"bar",data:t.companyData},{name:t.industryName,type:"bar",data:t.industryData}]};p.industryCompare.setOption(e)},Ct=()=>{r.value?g.value=!0:x.warning("请先选择企业")},It=async()=>{var t,e;if(r.value)if(v.title.trim())if(0!==v.sections.length)try{n.value=!0;const a={title:v.title,format:v.format,sections:v.sections,remarks:v.remarks},o=await(t=r.value,e=a,w({url:`/api/portrait/company/${t}/export-report`,method:"post",data:e})),i=new Blob([o.data],{type:o.headers["content-type"]}),l=document.createElement("a");l.href=URL.createObjectURL(i);const s=o.headers["content-disposition"]?o.headers["content-disposition"].split("filename=")[1]:`${v.title}.${v.format}`;l.download=decodeURIComponent(s),l.click(),URL.revokeObjectURL(l.href),g.value=!1,x.success("报告导出成功")}catch(a){console.error("导出报告失败:",a),x.error("报告导出失败，请重试")}finally{n.value=!1}else x.warning("请至少选择一项导出内容");else x.warning("请输入报告标题");else x.warning("请先选择企业")};return(t,o)=>{const p=I,y=_,w=b,x=T,C=E,D=M,W=O,B=A,U=S,j=R,N=z,Q=L,tt=P,et=V,ot=F,gt=k;return q(),X("div",nt,[Y(w,{class:"header-card"},{default:$((()=>[G("div",it,[o[10]||(o[10]=G("div",{class:"title"},[G("h2",null,"企业专利能力智能画像"),G("span",{class:"subtitle"},"专利数据智能分析 · 能力评估 · 趋势预测")],-1)),G("div",lt,[Y(y,{modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=t=>r.value=t),placeholder:"请选择企业",onChange:at,clearable:""},{default:$((()=>[(q(!0),X(H,null,J(e.value,(t=>(q(),K(p,{key:t.id,label:t.name,value:t.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])])),_:1}),r.value?(q(),X(H,{key:1},[Y(D,{gutter:20,class:"chart-row"},{default:$((()=>[Y(C,{xs:24,sm:24,md:12,lg:12,xl:12},{default:$((()=>[Y(w,{class:"chart-card"},{header:$((()=>[G("div",dt,[o[11]||(o[11]=G("span",null,"专利能力雷达分析",-1)),Y(y,{modelValue:i.value,"onUpdate:modelValue":o[1]||(o[1]=t=>i.value=t),placeholder:"时间范围",size:"small",onChange:rt},{default:$((()=>[Y(p,{label:"近1年",value:"1_year"}),Y(p,{label:"近3年",value:"3_years"}),Y(p,{label:"近5年",value:"5_years"}),Y(p,{label:"全部",value:"all"})])),_:1},8,["modelValue"])])])),default:$((()=>[G("div",{ref_key:"radarChartRef",ref:d,class:"chart-container radar-chart"},null,512)])),_:1})])),_:1}),Y(C,{xs:24,sm:24,md:12,lg:12,xl:12},{default:$((()=>[Y(w,{class:"chart-card"},{header:$((()=>o[12]||(o[12]=[G("div",{class:"card-header"},[G("span",null,"专利类型分布")],-1)]))),default:$((()=>[G("div",{ref_key:"pieChartRef",ref:u,class:"chart-container pie-chart"},null,512)])),_:1})])),_:1})])),_:1}),Y(D,{gutter:20,class:"chart-row"},{default:$((()=>[Y(C,{span:24},{default:$((()=>[Y(w,{class:"chart-card"},{header:$((()=>[G("div",ut,[o[16]||(o[16]=G("span",null,"专利趋势分析",-1)),G("div",ct,[Y(B,{modelValue:l.value,"onUpdate:modelValue":o[2]||(o[2]=t=>l.value=t),size:"small",onChange:pt},{default:$((()=>[Y(W,{label:"application"},{default:$((()=>o[13]||(o[13]=[Z("申请量")]))),_:1}),Y(W,{label:"granted"},{default:$((()=>o[14]||(o[14]=[Z("授权量")]))),_:1}),Y(W,{label:"valid"},{default:$((()=>o[15]||(o[15]=[Z("有效专利")]))),_:1})])),_:1},8,["modelValue"])])])])),default:$((()=>[G("div",{ref_key:"trendChartRef",ref:c,class:"chart-container trend-chart"},null,512)])),_:1})])),_:1})])),_:1}),Y(D,{gutter:20,class:"chart-row"},{default:$((()=>[Y(C,{xs:24,sm:24,md:12,lg:12,xl:12},{default:$((()=>[Y(w,{class:"chart-card"},{header:$((()=>o[17]||(o[17]=[G("div",{class:"card-header"},[G("span",null,"未来趋势预测"),G("span",{class:"info-tag"},"AI预测")],-1)]))),default:$((()=>[G("div",{ref_key:"forecastChartRef",ref:f,class:"chart-container forecast-chart"},null,512)])),_:1})])),_:1}),Y(C,{xs:24,sm:24,md:12,lg:12,xl:12},{default:$((()=>[Y(w,{class:"chart-card"},{header:$((()=>o[18]||(o[18]=[G("div",{class:"card-header"},[G("span",null,"智能标签分析"),G("span",{class:"info-tag"},"NLP提取")],-1)]))),default:$((()=>[G("div",{ref_key:"tagCloudRef",ref:h,class:"chart-container tag-cloud"},null,512)])),_:1})])),_:1})])),_:1}),Y(D,{gutter:20,class:"chart-row"},{default:$((()=>[Y(C,{span:24},{default:$((()=>[Y(w,{class:"chart-card"},{header:$((()=>[G("div",ft,[o[19]||(o[19]=G("span",null,"行业对比分析",-1)),Y(y,{modelValue:s.value,"onUpdate:modelValue":o[3]||(o[3]=t=>s.value=t),placeholder:"选择行业",size:"small",onChange:yt},{default:$((()=>[(q(!0),X(H,null,J(a.value,(t=>(q(),K(p,{key:t.code,label:t.name,value:t.code},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])),default:$((()=>[G("div",{ref_key:"industryCompareChartRef",ref:m,class:"chart-container industry-chart"},null,512)])),_:1})])),_:1})])),_:1}),G("div",ht,[Y(U,{type:"primary",onClick:Ct},{default:$((()=>o[20]||(o[20]=[Z("导出分析报告")]))),_:1})]),Y(gt,{modelValue:g.value,"onUpdate:modelValue":o[9]||(o[9]=t=>g.value=t),title:"导出分析报告",width:"500px","append-to-body":""},{footer:$((()=>[G("span",mt,[Y(U,{onClick:o[8]||(o[8]=t=>g.value=!1)},{default:$((()=>o[30]||(o[30]=[Z("取消")]))),_:1}),Y(U,{type:"primary",onClick:It,loading:n.value},{default:$((()=>o[31]||(o[31]=[Z(" 导出报告 ")]))),_:1},8,["loading"])])])),default:$((()=>[Y(ot,{model:v,"label-width":"120px"},{default:$((()=>[Y(N,{label:"报告标题"},{default:$((()=>[Y(j,{modelValue:v.title,"onUpdate:modelValue":o[4]||(o[4]=t=>v.title=t),placeholder:"请输入报告标题"},null,8,["modelValue"])])),_:1}),Y(N,{label:"导出格式"},{default:$((()=>[Y(B,{modelValue:v.format,"onUpdate:modelValue":o[5]||(o[5]=t=>v.format=t)},{default:$((()=>[Y(Q,{label:"pdf"},{default:$((()=>o[21]||(o[21]=[Z("PDF文档")]))),_:1}),Y(Q,{label:"docx"},{default:$((()=>o[22]||(o[22]=[Z("Word文档")]))),_:1}),Y(Q,{label:"xlsx"},{default:$((()=>o[23]||(o[23]=[Z("Excel表格")]))),_:1})])),_:1},8,["modelValue"])])),_:1}),Y(N,{label:"导出内容"},{default:$((()=>[Y(et,{modelValue:v.sections,"onUpdate:modelValue":o[6]||(o[6]=t=>v.sections=t)},{default:$((()=>[Y(tt,{label:"radar"},{default:$((()=>o[24]||(o[24]=[Z("能力雷达")]))),_:1}),Y(tt,{label:"category"},{default:$((()=>o[25]||(o[25]=[Z("类型分布")]))),_:1}),Y(tt,{label:"trend"},{default:$((()=>o[26]||(o[26]=[Z("趋势分析")]))),_:1}),Y(tt,{label:"forecast"},{default:$((()=>o[27]||(o[27]=[Z("预测分析")]))),_:1}),Y(tt,{label:"tags"},{default:$((()=>o[28]||(o[28]=[Z("标签分析")]))),_:1}),Y(tt,{label:"industry"},{default:$((()=>o[29]||(o[29]=[Z("行业对比")]))),_:1})])),_:1},8,["modelValue"])])),_:1}),Y(N,{label:"附加说明"},{default:$((()=>[Y(j,{modelValue:v.remarks,"onUpdate:modelValue":o[7]||(o[7]=t=>v.remarks=t),type:"textarea",rows:3,placeholder:"请输入附加说明内容（可选）"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])],64)):(q(),X("div",st,[Y(x,{description:"请选择企业以查看智能画像分析"})]))])}}}),[["__scopeId","data-v-2b752b8f"]]);export{pt as default};
