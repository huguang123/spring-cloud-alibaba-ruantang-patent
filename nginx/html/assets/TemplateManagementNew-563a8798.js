import{h as e}from"./errorHandler-e80e1e70.js";import{ai as a,b as l,L as t,K as s,V as n,G as r,a1 as o,$ as i,H as d,a2 as u,P as m,E as c,v as p,af as f,a5 as v,J as y}from"./elementPlus-e3fc6f82.js";import{x as g,r as b,X as x,c as h,k as w,z as k,A as V,P as _,H as T,u as $,G as N,K as C,y as U,O as K,a4 as R,L as j,M as z,C as E}from"./vue-4e979bb7.js";import{_ as P}from"./index-08374d78.js";const S={class:"template-management min-h-screen"},H={class:"container mx-auto p-4 max-w-7xl"},A={class:"flex justify-between items-center mb-6"},I={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},O={class:"relative"},L={class:"flex justify-end mt-4"},B={key:0,class:"py-32 flex justify-center items-center"},G={key:1,class:"py-16 text-center"},J={class:"mt-1 text-sm text-gray-500"},D={key:2},M={class:"text-sm text-gray-900 max-w-md truncate"},X={class:"flex justify-between items-center mt-4"},q={class:"text-sm text-gray-700"},F={class:"font-medium"},Q={class:"font-medium"},W={class:"overflow-y-auto custom-scrollbar"},Y={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},Z={class:"grid grid-cols-2 gap-4"},ee={class:"mb-6"},ae={class:"mb-6"},le={class:"bg-gray-50 p-3 rounded-md border border-gray-200"},te={key:0,class:"text-gray-500 text-sm italic"},se={key:1,class:"flex flex-wrap gap-2"},ne={class:"mb-6"},re={class:"flex justify-between items-center mb-2"},oe={class:"space-y-3"},ie={key:0,class:"text-gray-500 text-sm italic"},de={class:"flex justify-between items-start"},ue={class:"flex items-center"},me={class:"text-sm text-gray-600"},ce={class:"grid grid-cols-1 md:grid-cols-3 gap-3"},pe={class:"col-span-3"},fe={class:"col-span-3"},ve={key:0,class:"mt-2"},ye={class:"flex justify-end"},ge={key:0,class:"overflow-y-auto custom-scrollbar"},be={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},xe={class:"grid grid-cols-2 gap-4"},he={class:"text-gray-900"},we={class:"text-gray-900"},ke={class:"mb-6"},Ve={class:"text-sm text-gray-900 whitespace-pre-wrap"},_e={key:0,class:"text-gray-500 text-sm italic"},Te={key:1,class:"flex flex-wrap gap-2"},$e={key:0,class:"mt-4"},Ne={class:"flex items-center mb-2"},Ce={class:"text-sm text-gray-700 font-medium"},Ue={class:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-gray-600"},Ke={class:"ml-1"},Re={class:"ml-1"},je={class:"flex justify-end"},ze="/prom/api",Ee=P(g({__name:"TemplateManagementNew",setup(g){const P=b(!1),Ee=b([]),Pe=b(!1),Se=b(!1),He=b(null),Ae=b(0),Ie=b(1),Oe=b(10),Le=b(null),Be=x({id:null,sectionType:"",promName:"",content:"",weight:5,version:"1.0",enabled:!0,parameters:[]}),Ge=[{value:"技术问题",label:"技术问题"},{value:"技术效果",label:"技术效果"},{value:"技术方案",label:"技术方案"},{value:"背景技术",label:"背景技术"},{value:"实施例",label:"实施例"},{value:"附图说明",label:"附图说明"}],Je=["1.0","1.1","2.0"],De=x({sectionType:"",version:"",enabled:"",promName:""});function Me(){var e,a;const l=localStorage.getItem("auth_token")||(null==(a=null==(e=window.auth)?void 0:e.getToken)?void 0:a.call(e)),t={"Content-Type":"application/json"};return l&&(t.Authorization=`Bearer ${l}`),t}const Xe=h((()=>!!De.sectionType||!!De.version||""!==De.enabled||!!De.promName)),qe=h((()=>na(Be.content))),Fe=h((()=>He.value?na(He.value.content):[])),Qe=h((()=>Boolean(Be.sectionType&&Be.content))),We=h((()=>{let e=Ee.value||[];if(De.sectionType&&(e=e.filter((e=>(null==e?void 0:e.sectionType)===De.sectionType))),De.version&&(e=e.filter((e=>(null==e?void 0:e.version)===De.version))),""!==De.enabled){const a=De.enabled;e=e.filter((e=>(null==e?void 0:e.enabled)===a))}if(De.promName){const a=De.promName.toLowerCase();e=e.filter((e=>{var l;return null==(l=null==e?void 0:e.promName)?void 0:l.toLowerCase().includes(a)}))}return e}));function Ye(e){if(!e)return"";return{"技术问题":"badge-blue","技术效果":"badge-green","技术方案":"badge-purple","背景技术":"badge-yellow","实施例":"badge-red"}[e]||""}function Ze(){Object.assign(Be,{id:null,sectionType:"",promName:"",content:"",weight:5,version:"1.0",enabled:!0,parameters:[]}),Pe.value=!0}async function ea(a){try{const e=await fetch(`${ze}/prom-templates/${a}`,{headers:Me()});if(!e.ok)throw new Error(`HTTP error: ${e.status}`);const l=await e.json();if(200!==l.code)throw new Error(l.message||"获取模板详情失败");return l.data}catch(l){return e(l,"获取模板详情失败"),null}}function aa(){Pe.value=!1}async function la(){var a;if(Qe.value){if((null==(a=Be.parameters)?void 0:a.length)>0){if(Be.parameters.find((e=>{var a;return!(null==(a=e.paramKey)?void 0:a.trim())})))return void c.warning("变量名称不能为空")}P.value=!0;try{const e={sectionType:Be.sectionType,promName:Be.promName||Be.sectionType+"模板",content:Be.content,weight:parseInt(String(Be.weight))||5,version:Be.version||"1.0",enabled:Be.enabled,parameters:Be.parameters.map((e=>({paramKey:e.paramKey,promRole:Number(e.promRole),defaultValue:e.defaultValue||"",enterReminder:e.enterReminder||"",description:e.description||""})))};let a;if(console.log("保存模板数据:",e),Be.id?(e.id=Be.id,a=await fetch(`${ze}/prom-templates/${Be.id}`,{method:"PUT",headers:Me(),body:JSON.stringify(e)})):a=await fetch(`${ze}/prom-templates`,{method:"POST",headers:Me(),body:JSON.stringify(e)}),!a.ok)throw new Error(`HTTP error: ${a.status}`);const l=await a.json();if(200!==l.code)throw new Error(l.message||"保存失败");c.success("保存成功"),Pe.value=!1,ua()}catch(l){e(l,"保存模板失败")}finally{P.value=!1}}else c.warning("请填写必填字段")}function ta(){Object.assign(De,{sectionType:"",version:"",enabled:"",promName:""}),ua()}function sa(){Ie.value=1,ua()}function na(e){if(!e)return[];const a=/\${([^}]+)}/g,l=[];let t;for(;null!==(t=a.exec(e));){const e=t[1].trim();e&&!l.some((a=>a.paramKey===e))&&l.push({paramKey:e,description:"",defaultValue:"",enterReminder:`请输入${e}`,promRole:1})}return l}function ra(){const e=na(Be.content);if(0===e.length)return void c.warning("未在模板内容中检测到变量。变量格式示例：${user_input}");const a=[];for(const l of e){const e=Be.parameters.find((e=>e.paramKey===l.paramKey));e?a.push(e):a.push({paramKey:l.paramKey,description:`${l.paramKey} 参数`,defaultValue:"",enterReminder:`请输入 ${l.paramKey}`,promRole:1})}Be.parameters=a}function oa(){Be.parameters||(Be.parameters=[]),Be.parameters.push({paramKey:"",description:"",defaultValue:"",enterReminder:"",promRole:1})}function ia(e){Oe.value=e,ua()}function da(e){Ie.value=e,ua()}async function ua(){P.value=!0,Le.value=null;try{const e=new URLSearchParams({pageNum:Ie.value.toString(),pageSize:Oe.value.toString(),...De.sectionType&&{sectionType:De.sectionType},...De.promName&&{promName:De.promName},...""!==De.enabled&&{enabled:String(De.enabled)},...De.version&&{version:De.version}}),a=await fetch(`${ze}/prom-templates?${e.toString()}`,{method:"GET",headers:Me()});if(!a.ok)throw new Error(`HTTP error: ${a.status}`);const l=await a.json();if(console.log("API返回数据:",l),200!==l.code)throw new Error(l.message||"操作失败");(null==l?void 0:l.data)?Array.isArray(l.data.records)?(Ee.value=l.data.records,Ae.value=parseInt(String(l.data.total))||l.data.records.length,0!==Ee.value.length||Xe.value||console.log("没有找到模板数据")):(console.warn("API返回的records不是数组:",l.data),Ee.value=[],Ae.value=0):(Ee.value=[],Ae.value=0,console.warn("API返回的数据为空"))}catch(a){Ee.value=[],Ae.value=0,e(a,"加载模板列表失败")}finally{P.value=!1}}return w((()=>{try{ua()}catch(e){console.error("页面初始化失败:",e),Le.value="页面初始化失败"}})),(g,b)=>{const x=f,h=v,w=y,na=a;return U(),k("div",S,[V("div",H,[V("div",A,[b[16]||(b[16]=V("h1",{class:"text-2xl font-bold text-gray-800"},"提示词模板管理",-1)),_($(l),{type:"primary",onClick:Ze},{default:T((()=>b[15]||(b[15]=[V("i",{class:"fas fa-plus mr-2"},null,-1),V("span",null,"新建模板",-1)]))),_:1})]),_($(r),{class:"mb-6"},{default:T((()=>[V("div",I,[V("div",null,[b[17]||(b[17]=V("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"模板类型",-1)),_($(t),{modelValue:De.sectionType,"onUpdate:modelValue":b[0]||(b[0]=e=>De.sectionType=e),class:"w-full",placeholder:"全部类型",clearable:""},{default:T((()=>[(U(),k(K,null,R(Ge,(e=>_($(s),{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])]),V("div",null,[b[18]||(b[18]=V("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"版本",-1)),_($(t),{modelValue:De.version,"onUpdate:modelValue":b[1]||(b[1]=e=>De.version=e),class:"w-full",placeholder:"全部版本",clearable:""},{default:T((()=>[(U(),k(K,null,R(Je,(e=>_($(s),{key:e,label:e,value:e},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])]),V("div",null,[b[19]||(b[19]=V("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"状态",-1)),_($(t),{modelValue:De.enabled,"onUpdate:modelValue":b[2]||(b[2]=e=>De.enabled=e),class:"w-full",placeholder:"全部状态",clearable:""},{default:T((()=>[_($(s),{label:"启用",value:!0}),_($(s),{label:"禁用",value:!1})])),_:1},8,["modelValue"])]),V("div",null,[b[21]||(b[21]=V("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"关键词",-1)),V("div",O,[_($(n),{modelValue:De.promName,"onUpdate:modelValue":b[3]||(b[3]=e=>De.promName=e),placeholder:"搜索模板名称...",clearable:""},{prefix:T((()=>b[20]||(b[20]=[V("i",{class:"fas fa-search text-gray-400"},null,-1)]))),_:1},8,["modelValue"])])])]),V("div",L,[_($(l),{onClick:ta,class:"mr-2"},{default:T((()=>b[22]||(b[22]=[V("i",{class:"fas fa-undo-alt mr-1"},null,-1),j(" 重置 ")]))),_:1}),_($(l),{type:"primary",onClick:sa},{default:T((()=>b[23]||(b[23]=[V("i",{class:"fas fa-filter mr-1"},null,-1),j(" 筛选 ")]))),_:1})])])),_:1}),_($(r),{class:"shadow-sm"},{header:T((()=>b[24]||(b[24]=[V("h2",{class:"text-lg font-medium text-gray-900"},"模板列表",-1)]))),default:T((()=>[P.value?(U(),k("div",B,b[25]||(b[25]=[V("div",{class:"spinner mr-3"},null,-1),V("span",{class:"text-gray-600"},"加载中...",-1)]))):0===We.value.length?(U(),k("div",G,[b[26]||(b[26]=V("div",{class:"text-5xl text-gray-300 mb-4"},[V("i",{class:"fas fa-file-alt"})],-1)),b[27]||(b[27]=V("h3",{class:"text-lg font-medium text-gray-900"},"没有找到模板",-1)),V("p",J,z(Xe.value?"没有符合筛选条件的模板，请调整筛选条件":'请点击"新建模板"按钮创建新的模板'),1)])):(U(),k("div",D,[_($(o),{data:We.value,border:"",style:{width:"100%"}},{default:T((()=>[_($(i),{label:"模板类型",width:"130"},{default:T((({row:e})=>[V("span",{class:E(["badge",Ye(e.sectionType)])},z(e.sectionType),3)])),_:1}),_($(i),{prop:"promName",label:"模板名称",width:"180"},{default:T((({row:e})=>[j(z(e.promName||"未命名模板"),1)])),_:1}),_($(i),{prop:"content",label:"内容预览"},{default:T((({row:e})=>[V("div",M,z(e.content),1)])),_:1}),_($(i),{prop:"weight",label:"优先级",width:"100"}),_($(i),{prop:"version",label:"版本",width:"100"}),_($(i),{label:"状态",width:"100",align:"center"},{default:T((({row:e})=>[_($(d),{type:e.enabled?"success":"danger",size:"small"},{default:T((()=>[j(z(e.enabled?"启用":"禁用"),1)])),_:2},1032,["type"])])),_:1}),_($(i),{label:"操作",width:"220",fixed:"right"},{default:T((({row:a})=>[_($(l),{type:"primary",link:"",onClick:l=>async function(a){P.value=!0;try{const e=await ea(a.id);if(!e)throw new Error("获取模板详情失败");console.log("获取到的模板详情:",e),Object.assign(Be,{id:e.id,sectionType:e.sectionType,promName:e.promName,content:e.content,weight:e.weight||5,version:e.version||"1.0",enabled:e.enabled,parameters:(e.parameters||[]).map((e=>({paramKey:e.name||e.paramKey,type:e.type||"string",defaultValue:e.defaultValue||"",description:e.description||"",enterReminder:e.enterReminder||"",promRole:void 0!==e.promRole?Number(e.promRole):1})))}),console.log("处理后的编辑模板数据:",Be),Pe.value=!0}catch(l){e(l,"编辑模板失败")}finally{P.value=!1}}(a)},{default:T((()=>b[28]||(b[28]=[V("i",{class:"fas fa-edit mr-1"},null,-1),j(" 编辑 ")]))),_:2},1032,["onClick"]),_($(l),{type:a.enabled?"danger":"success",link:"",onClick:l=>async function(a){const l=!a.enabled;P.value=!0;try{const e=await fetch(`${ze}/prom-templates/${a.id}/status?enabled=${l}`,{method:"PATCH",headers:Me()});if(!e.ok)throw new Error(`HTTP error: ${e.status}`);const t=await e.json();if(200!==t.code)throw new Error(t.message||"状态更新失败");const s=Ee.value.findIndex((e=>e.id===a.id));-1!==s&&(Ee.value[s].enabled=l),c.success(t.message||"状态更新成功")}catch(t){e(t,"更新状态失败")}finally{P.value=!1}}(a)},{default:T((()=>[V("i",{class:E(a.enabled?"fas fa-ban":"fas fa-check-circle")},null,2),j(" "+z(a.enabled?"禁用":"启用"),1)])),_:2},1032,["type","onClick"]),_($(l),{type:"info",link:"",onClick:l=>async function(a){P.value=!0;try{const e=await ea(a.id);e&&(He.value=e,Se.value=!0)}catch(l){e(l,"查看模板详情失败")}finally{P.value=!1}}(a)},{default:T((()=>b[29]||(b[29]=[V("i",{class:"fas fa-eye mr-1"},null,-1),j(" 详情 ")]))),_:2},1032,["onClick"]),_($(l),{type:"danger",link:"",onClick:l=>async function(a){p.confirm("确定要删除该模板吗？此操作不可恢复。","删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{P.value=!0;try{const e=await fetch(`${ze}/prom-templates/${a.id}`,{method:"DELETE",headers:Me()});if(!e.ok)throw new Error(`HTTP error: ${e.status}`);const l=await e.json();if(200!==l.code)throw new Error(l.message||"删除失败");c.success("删除成功"),ua()}catch(l){e(l,"删除模板失败")}finally{P.value=!1}})).catch((()=>{}))}(a)},{default:T((()=>b[30]||(b[30]=[V("i",{class:"fas fa-trash mr-1"},null,-1),j(" 删除 ")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),V("div",X,[V("div",q,[b[31]||(b[31]=j(" 显示 ")),V("span",F,z(We.value.length),1),b[32]||(b[32]=j(" 个模板中的 ")),V("span",Q,z(Ae.value),1),b[33]||(b[33]=j(" 个 "))]),_($(u),{"current-page":Ie.value,"onUpdate:currentPage":b[4]||(b[4]=e=>Ie.value=e),"page-size":Oe.value,"onUpdate:pageSize":b[5]||(b[5]=e=>Oe.value=e),"page-sizes":[5,10,20,50],layout:"total, sizes, prev, pager, next",total:Ae.value,onSizeChange:ia,onCurrentChange:da},null,8,["current-page","page-size","total"])])]))])),_:1}),_($(m),{modelValue:Pe.value,"onUpdate:modelValue":b[12]||(b[12]=e=>Pe.value=e),title:Be.id?"编辑模板":"创建模板",width:"60%","destroy-on-close":""},{footer:T((()=>[V("div",ye,[_($(l),{onClick:aa},{default:T((()=>b[53]||(b[53]=[j("取消")]))),_:1}),_($(l),{type:"primary",onClick:la,disabled:!Qe.value},{default:T((()=>b[54]||(b[54]=[j(" 保存 ")]))),_:1},8,["disabled"])])])),default:T((()=>[V("div",W,[V("div",Y,[V("div",null,[b[34]||(b[34]=V("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[j("模板类型 "),V("span",{class:"text-red-600"},"*")],-1)),_($(t),{modelValue:Be.sectionType,"onUpdate:modelValue":b[6]||(b[6]=e=>Be.sectionType=e),class:"w-full",placeholder:"请选择模板类型"},{default:T((()=>[_($(s),{value:"背景技术",label:"背景技术"}),_($(s),{value:"技术问题",label:"技术问题"}),_($(s),{value:"技术效果",label:"技术效果"}),_($(s),{value:"技术方案",label:"技术方案"}),_($(s),{value:"实施例",label:"实施例"}),_($(s),{value:"附图说明",label:"附图说明"})])),_:1},8,["modelValue"])]),V("div",null,[b[35]||(b[35]=V("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[j("模板名称 "),V("span",{class:"text-red-600"},"*")],-1)),_($(n),{modelValue:Be.promName,"onUpdate:modelValue":b[7]||(b[7]=e=>Be.promName=e),placeholder:"请输入模板名称，如'标准技术问题生成器'"},null,8,["modelValue"])]),V("div",Z,[V("div",null,[b[36]||(b[36]=V("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"版本",-1)),_($(n),{modelValue:Be.version,"onUpdate:modelValue":b[8]||(b[8]=e=>Be.version=e),placeholder:"如：1.0"},null,8,["modelValue"])]),V("div",null,[b[37]||(b[37]=V("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"优先级",-1)),_(x,{modelValue:Be.weight,"onUpdate:modelValue":b[9]||(b[9]=e=>Be.weight=e),min:1,max:10,class:"w-full"},null,8,["modelValue"])])])]),V("div",ee,[b[38]||(b[38]=V("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[j("模板内容 "),V("span",{class:"text-red-600"},"*")],-1)),_($(n),{modelValue:Be.content,"onUpdate:modelValue":b[10]||(b[10]=e=>Be.content=e),type:"textarea",rows:8,placeholder:"请输入模板内容，可以使用${variable_name}格式的变量占位符"},null,8,["modelValue"])]),V("div",ae,[b[39]||(b[39]=V("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"模板变量",-1)),V("div",le,[0===qe.value.length?(U(),k("div",te," 未检测到变量。变量格式示例：${user_input}、${spark_approach} ")):(U(),k("div",se,[(U(!0),k(K,null,R(qe.value,(e=>(U(),N($(d),{key:e.paramKey,type:"info",class:"m-1"},{default:T((()=>[j(" $"+z("{"+e.paramKey+"}"),1)])),_:2},1024)))),128))]))])]),V("div",ne,[V("div",re,[b[41]||(b[41]=V("label",{class:"block text-sm font-medium text-gray-700"},"模板变量配置",-1)),_($(l),{type:"primary",size:"small",plain:"",onClick:oa},{default:T((()=>b[40]||(b[40]=[V("i",{class:"fas fa-plus mr-1"},null,-1),j(" 添加变量配置 ")]))),_:1})]),V("div",oe,[Be.parameters&&0===Be.parameters.length?(U(),k("div",ie," 未添加变量配置。请为模板变量添加配置信息。 ")):C("",!0),(U(!0),k(K,null,R(Be.parameters,((e,a)=>(U(),N($(r),{key:a,class:"mb-3"},{header:T((()=>[V("div",de,[V("div",ue,[_($(d),{type:"success",class:"mr-2"},{default:T((()=>[j(" $"+z("{"+e.paramKey+"}"),1)])),_:2},1024),V("span",me,z(e.description),1)]),_($(l),{type:"danger",icon:"Delete",circle:"",plain:"",size:"small",onClick:e=>function(e){Be.parameters.splice(e,1)}(a)},null,8,["onClick"])])])),default:T((()=>[V("div",ce,[V("div",null,[b[42]||(b[42]=V("label",{class:"block text-xs font-medium text-gray-500 mb-1"},"变量名称",-1)),_($(n),{modelValue:e.paramKey,"onUpdate:modelValue":a=>e.paramKey=a,size:"small",placeholder:"变量名称"},null,8,["modelValue","onUpdate:modelValue"])]),V("div",null,[b[43]||(b[43]=V("label",{class:"block text-xs font-medium text-gray-500 mb-1"},"变量描述",-1)),_($(n),{modelValue:e.description,"onUpdate:modelValue":a=>e.description=a,size:"small",placeholder:"变量描述"},null,8,["modelValue","onUpdate:modelValue"])]),V("div",null,[b[44]||(b[44]=V("label",{class:"block text-xs font-medium text-gray-500 mb-1"},"默认值",-1)),_($(n),{modelValue:e.defaultValue,"onUpdate:modelValue":a=>e.defaultValue=a,size:"small",placeholder:"默认值"},null,8,["modelValue","onUpdate:modelValue"])]),V("div",pe,[b[45]||(b[45]=V("label",{class:"block text-xs font-medium text-gray-500 mb-1"},"输入提示",-1)),_($(n),{modelValue:e.enterReminder,"onUpdate:modelValue":a=>e.enterReminder=a,size:"small",placeholder:"用户输入提示"},null,8,["modelValue","onUpdate:modelValue"])]),V("div",fe,[b[48]||(b[48]=V("label",{class:"block text-xs font-medium text-gray-500 mb-1"},"提示词类型",-1)),_(w,{modelValue:e.promRole,"onUpdate:modelValue":a=>e.promRole=a},{default:T((()=>[_(h,{label:0},{default:T((()=>b[46]||(b[46]=[j("系统提示词")]))),_:1}),_(h,{label:1},{default:T((()=>b[47]||(b[47]=[j("用户提示词")]))),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue"])])])])),_:2},1024)))),128))]),qe.value.length>0&&(!Be.parameters||0===Be.parameters.length)?(U(),k("div",ve,[_($(l),{type:"primary",link:"",onClick:ra},{default:T((()=>b[49]||(b[49]=[V("i",{class:"fas fa-magic mr-1"},null,-1),j(" 从模板内容自动提取变量配置 ")]))),_:1})])):C("",!0)]),V("div",null,[b[52]||(b[52]=V("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"状态",-1)),_(w,{modelValue:Be.enabled,"onUpdate:modelValue":b[11]||(b[11]=e=>Be.enabled=e)},{default:T((()=>[_(h,{label:!0},{default:T((()=>b[50]||(b[50]=[j("启用")]))),_:1}),_(h,{label:!1},{default:T((()=>b[51]||(b[51]=[j("禁用")]))),_:1})])),_:1},8,["modelValue"])])])])),_:1},8,["modelValue","title"]),_($(m),{modelValue:Se.value,"onUpdate:modelValue":b[14]||(b[14]=e=>Se.value=e),title:"模板详情",width:"60%"},{footer:T((()=>[V("div",je,[_($(l),{onClick:b[13]||(b[13]=e=>Se.value=!1)},{default:T((()=>b[64]||(b[64]=[j("关闭")]))),_:1})])])),default:T((()=>[He.value?(U(),k("div",ge,[V("div",be,[V("div",null,[b[55]||(b[55]=V("div",{class:"text-sm font-medium text-gray-500 mb-1"},"模板类型",-1)),V("div",null,[V("span",{class:E(["badge",Ye(He.value.sectionType)])},z(He.value.sectionType),3)])]),V("div",xe,[V("div",null,[b[56]||(b[56]=V("div",{class:"text-sm font-medium text-gray-500 mb-1"},"版本",-1)),V("div",he,z(He.value.version),1)]),V("div",null,[b[57]||(b[57]=V("div",{class:"text-sm font-medium text-gray-500 mb-1"},"优先级",-1)),V("div",we,z(He.value.weight),1)])])]),V("div",ke,[b[58]||(b[58]=V("div",{class:"text-sm font-medium text-gray-500 mb-1"},"模板内容",-1)),_($(r),{class:"bg-gray-50"},{default:T((()=>[V("pre",Ve,z(He.value.content),1)])),_:1})]),V("div",null,[b[59]||(b[59]=V("div",{class:"text-sm font-medium text-gray-500 mb-1"},"模板变量",-1)),_($(r),{class:"bg-gray-50"},{default:T((()=>[0===Fe.value.length?(U(),k("div",_e," 未检测到变量 ")):(U(),k("div",Te,[(U(!0),k(K,null,R(Fe.value,(e=>(U(),N($(d),{key:e.paramKey,type:"info",class:"m-1"},{default:T((()=>[j(" $"+z("{"+e.paramKey+"}"),1)])),_:2},1024)))),128))]))])),_:1})]),He.value.parameters&&He.value.parameters.length>0?(U(),k("div",$e,[b[63]||(b[63]=V("div",{class:"text-sm font-medium text-gray-500 mb-1"},"变量配置详情",-1)),_($(r),{class:"bg-gray-50"},{default:T((()=>[(U(!0),k(K,null,R(He.value.parameters,(e=>(U(),k("div",{key:e.paramKey,class:"mb-3"},[_($(r),null,{default:T((()=>[V("div",Ne,[_($(d),{type:"success",class:"mr-2"},{default:T((()=>[j(" $"+z("{"+e.paramKey+"}"),1)])),_:2},1024),V("span",Ce,z(e.description),1)]),V("div",Ue,[V("div",null,[b[60]||(b[60]=V("span",{class:"text-xs text-gray-500"},"默认值:",-1)),V("span",Ke,z(e.defaultValue||"(无)"),1)]),V("div",null,[b[61]||(b[61]=V("span",{class:"text-xs text-gray-500"},"输入提示:",-1)),V("span",Re,z(e.enterReminder||"(无)"),1)]),V("div",null,[b[62]||(b[62]=V("span",{class:"text-xs text-gray-500"},"提示词类型:",-1)),_($(d),{size:"small",type:0===e.promRole?"primary":"warning"},{default:T((()=>[j(z(0===e.promRole?"系统提示词":"用户提示词"),1)])),_:2},1032,["type"])])])])),_:2},1024)])))),128))])),_:1})])):C("",!0)])):C("",!0)])),_:1},8,["modelValue"]),Le.value?(U(),N(na,{key:0,title:Le.value,type:"error","show-icon":"",class:"mb-4"},null,8,["title"])):C("",!0)])])}}}),[["__scopeId","data-v-e8343912"]]);export{Ee as default};
